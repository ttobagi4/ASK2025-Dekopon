# 🏅 ASK2025 (동계방학 진행)
🍊 주제 : 딥러닝 모델과 OpenCV를 활용한 한라봉 병징 탐지 및 발병 분석

기후 변화로 한라봉 재배 환경이 달라지면서 병해 발생 빈도와 심각성이 증가하고 있다. 그러나 기존 병해 판별 방식은 주관적 오류가 발생하기 쉽고, 시간이 많이 소요되어 효율적인 관리가 어렵다. 따라서, 보다 빠르고 정확한 병해 진단 자동화 시스템의 필요성이 커지고 있다. 본 연구에서는 딥러닝 모델과 OpenCV를 활용하여 한라봉 잎과 과실의 병징을 자동 감지하고, 확산 정도를 정량적으로 평가함으로써 농업 종사자의 신속한 대응을 지원하고 농가의 생산성과 상품 품질 향상에 기여하고자 한다.

- 저자 : 김민지, 박세훈, 신의식, 류병석, 권용현, 김영균
  
## 1️⃣ 데이터셋
- 한국지능정보사회진흥원(NIA) AI-HUB 국내 재배 아열대·열대 병해충 데이터
- 한라봉 잎(정상, 궤양병, 점무늬병, 귤굴나방) & 과실(정상, 총채벌레) 원천데이터 총 4,320장

## 2️⃣ 내용
#### 1. 이미지 불러오기
#### 2. 딥러닝 기반 병징 검출 - Faster R-CNN
- 검출 대상 : 정상 잎, 정상 과실, 궤양병, 점무늬병, 귤굴나방, 총채벌레 (총 6종)
- SGD 옵티마이저 + 학습률 감소 스케줄러 (과적합 방지)
#### 3. 이미지 처리 기반 병징 분석 (공통 처리)
- HSV 변환
- 색상 필터링 → GrabCut → 잎/과실 영역 추출
#### 4. 궤양병
- HSV 필터 + Blur 마스크로 배경 제거
- 최대 윤곽선만 유지 후 병징 필터 적용
#### 5. 점무늬병 & 귤굴나방
- 채도, 명도 기반 필터 2종 적용
- 잎 경계 겹칠 시 좌표 보정
- 병징 면적 비율 계산
#### 6. 총채벌레
- 과실 색상(H 값) 분류 (Yellow, Green 등)
- 색 차이 3 이상 → 병징으로 판단
- 과숙 과실 오탐 방지를 위한 Sobel 필터 적용

![result(ex)](https://github.com/ttobagi4/ASK2025_Dekopon/blob/main/result(ex).png)

## 3️⃣ 연구 결과
- 재학습된 Faster R-CNN 모델의 전체 mAP : 0.7812
- AP@0.5 : 정상 잎 0.668, 정상 과실 0.912, 궤양병 0.750, 점무늬병 0.977, 귤굴나방 0.428, 총채벌레 0.952

![PR Curve](https://github.com/ttobagi4/ASK2025_Dekopon/blob/main/PR%20Curve.png)

## 4️⃣ 한계 & 보완할 점들
- 병징 초기 단계에서는 검출 성능이 다소 저하되는 경향
- 추가적인 데이터 확보와 세분화된 학습 진행하여 모델의 성능 및 일반화 향상 필요
- 다양한 작물에 적용할 수 있는 범용 모델을 개발하여 병징 데이터셋 확장
